{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/BackupOfApp/final%20frontend%20datathon/src/components/dashboard/LeafletMap.jsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useMemo, useState, useId } from \"react\";\r\nimport { MapContainer, TileLayer, Marker, Popup, useMap } from \"react-leaflet\";\r\nimport \"leaflet/dist/leaflet.css\";\r\nimport L from \"leaflet\";\r\nimport ReactDOMServer from \"react-dom/server\";\r\n// Minimal neon dot icon\r\nfunction buildDotIcon(color = \"#22d3ee\") {\r\n    const html = ReactDOMServer.renderToString(\r\n        <div className=\"relative flex items-center justify-center\">\r\n            <span\r\n                style={{ backgroundColor: color, boxShadow: `0 0 8px ${color}` }}\r\n                className=\"inline-flex h-3 w-3 rounded-full\"\r\n            />\r\n        </div>\r\n    );\r\n\r\n    return L.divIcon({\r\n        html,\r\n        className: \"custom-div-icon\",\r\n        iconSize: [16, 16],\r\n        iconAnchor: [8, 8],\r\n        popupAnchor: [0, -6],\r\n    });\r\n}\r\n\r\n// Styled popup content\r\nfunction PopupCard({ title, congestion, band, speed }) {\r\n    const color = congestion >= 80 ? \"text-red-400\" : congestion >= 60 ? \"text-amber-400\" : \"text-emerald-400\";\r\n    return (\r\n        <div className=\"min-w-[200px] rounded-xl border border-white/10 bg-background/80 backdrop-blur-md px-3 py-2 shadow-xl\">\r\n            <p className=\"font-semibold text-foreground\">{title}</p>\r\n            <p className={`text-sm font-semibold ${color}`}>Congestion: {Math.round(congestion)}%{band ? ` (${band})` : \"\"}</p>\r\n            {speed != null && (\r\n                <p className=\"text-xs font-mono text-muted-foreground\">Speed: {speed.toFixed?.(1) ?? speed} km/h</p>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default function LeafletMap({ center = [19.0760, 72.8777], zoom = 12, markers = [], onMarkerClick, tileTheme = \"dark\" }) {\r\n    const [mounted, setMounted] = useState(false);\r\n    const rawId = useId();\r\n    const mapDomId = useMemo(() => `leaflet-${rawId}`, [rawId]);\r\n\r\n    useEffect(() => {\r\n        setMounted(true);\r\n        return () => {\r\n            const container = L.DomUtil.get(mapDomId);\r\n            if (container && container._leaflet_id) {\r\n                container._leaflet_id = null;\r\n            }\r\n        };\r\n    }, [mapDomId]);\r\n\r\n    const cleanMarkers = useMemo(\r\n        () => (markers || []).filter((m) => m?.lat != null && m?.lng != null),\r\n        [markers]\r\n    );\r\n    const hasMarkers = cleanMarkers.length > 0;\r\n\r\n    const bounds = useMemo(() => {\r\n        if (!hasMarkers) return null;\r\n        const latlngs = cleanMarkers.map(m => [m.lat, m.lng]);\r\n        return L.latLngBounds(latlngs);\r\n    }, [cleanMarkers, hasMarkers]);\r\n\r\n    return (\r\n        <div className=\"w-full h-full min-h-[500px] relative z-0 rounded-xl overflow-hidden border border-border/50\">\r\n            {mounted ? (\r\n                <MapContainer\r\n                    id={mapDomId}\r\n                    center={center}\r\n                    zoom={zoom}\r\n                    style={{ height: \"100%\", width: \"100%\" }}\r\n                    className=\"z-0\"\r\n                >\r\n                    <TileLayer\r\n                        attribution='&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\r\n                        url={tileTheme === \"light\"\r\n                            ? \"https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png\"\r\n                            : \"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png\"}\r\n                        className=\"map-tiles\"\r\n                    />\r\n\r\n                    <MapController center={center} zoom={zoom} bounds={bounds} />\r\n\r\n                    {cleanMarkers.map((marker) => {\r\n                        const icon = buildDotIcon(marker.color || \"#22d3ee\");\r\n                        return (\r\n                            <Marker\r\n                                key={marker.id}\r\n                                position={[marker.lat, marker.lng]}\r\n                                icon={icon}\r\n                                eventHandlers={\r\n                                    onMarkerClick\r\n                                        ? { click: () => onMarkerClick(marker.linkedId || marker.id) }\r\n                                        : undefined\r\n                                }\r\n                            >\r\n                                <Popup>\r\n                                    {marker.popupContent ? marker.popupContent : (\r\n                                        <PopupCard\r\n                                            title={marker.title || marker.road_name || marker.road_id}\r\n                                            congestion={marker.congestion ?? 0}\r\n                                            band={marker.band}\r\n                                            speed={marker.speed}\r\n                                        />\r\n                                    )}\r\n                                </Popup>\r\n                            </Marker>\r\n                        );\r\n                    })}\r\n                </MapContainer>\r\n            ) : (\r\n                <div className=\"w-full h-full min-h-[500px] rounded-xl bg-muted/40\" />\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n// Component to handle map interactions or updates\r\nfunction MapController({ center, zoom, bounds }) {\r\n    const map = useMap();\r\n\r\n    useEffect(() => {\r\n        map.invalidateSize();\r\n    }, [map]);\r\n\r\n    useEffect(() => {\r\n        if (bounds) {\r\n            map.fitBounds(bounds, { padding: [24, 24] });\r\n        } else {\r\n            map.setView(center, zoom, { animate: true });\r\n        }\r\n    }, [map, center, zoom, bounds]);\r\n\r\n    return null;\r\n}\r\n"],"names":[],"mappings":"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"}}]
}